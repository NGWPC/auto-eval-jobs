id: mosaic-extents
description: Mosaics and homogenizes overlapping flood observations (raster or vector) into a combined dataset with optional clipping/reprojection
outputTransmission:
  - reference
arguments:
  targetResolution:
    title: Target Resolution
    description: Resolution in CRS units (required for raster outputs)
    schema:
      type: object
      properties:
        x:
          type: number
          minimum: 0
          exclusiveMinimum: true
        y: 
          type: number
          minimum: 0
          exclusiveMinimum: true
      required: [x, y]
inputs:
  inputFiles:
    title: Input Datasets
    description: Array of flood observations (rasters or vector features)
    schema:
      type: array
      items:
        oneOf:
          - type: string
            format: uri
            contentMediaType: image/tiff; application=geotiff
          - type: string
            format: uri
            contentMediaType: application/geo+json
          - type: string  
            format: uri
            contentMediaType: application/geopackage+gpkg
            parameters:
              layer_type: polygon
      minItems: 1
  clipGeometry:
    title: Clipping Geometry
    description: Optional GeoJSON polygon for clipping output
    schema:
      oneOf:
        - allOf:
          - format: geojson-geometry
          - $ref: http://schemas.opengis.net/ogcapi/features/part1/1.0/openapi/schemas/geometryGeoJSON.yaml
    minOccurs: 0
  targetCRS:
    title: Target CRS
    description: Coordinate reference system for output as EPSG code (e.g. EPSG:4326)
    schema:
      type: string
      pattern: ^EPSG:[0-9]+$
outputs:
  mosaickedResult:
    title: Combined Dataset
    description: Unified flood observation data in raster or vector format
    schema:
      oneOf:
        - type: string
          format: uri
          contentMediaType: image/tiff; application=geotiff
        - type: string
          format: uri
          contentMediaType: application/geopackage+gpkg
          parameters: 
            geometry_type: polygon
